# –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–∞—Ü–∏–µ–Ω—Ç ‚Äî Web + Telegram + –≥–æ–ª–æ—Å + —Ä–µ–∂–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è

–í –ø—Ä–æ–µ–∫—Ç–µ:

- `backend/` ‚Äî FastAPI-—Å–µ—Ä–≤–µ—Ä —Å –∫–µ–π—Å–∞–º–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏ API –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è.
- `frontend/` ‚Äî –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
  - —Ä–µ–∂–∏–º —Å—Ç—É–¥–µ–Ω—Ç–∞ (—Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º–∞—è —á–∞—Å—Ç—å –∫–µ–π—Å–∞)
  - **—Ä–µ–∂–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è** (–ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å + —Ö–æ–¥ —Å–µ—Å—Å–∏–∏)
- `bot/` ‚Äî Telegram-–±–æ—Ç:
  - –≤—ã–±–æ—Ä –∫–µ–π—Å–∞
  - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –¥–∏–∞–ª–æ–≥
  - –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –∏ –≤—ã–≤–æ–¥ (Speech-to-Text –∏ Text-to-Speech OpenAI)

---

## 0. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

–ù—É–∂–Ω–æ:

- Python 3.10+  
- –ê–∫–∫–∞—É–Ω—Ç OpenAI —Å —Ä–∞–±–æ—á–∏–º `OPENAI_API_KEY`  
- –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ –æ—Ç `@BotFather`

---

## 1. –ó–∞–ø—É—Å–∫ backend (FastAPI)

```bash
cd backend
python -m venv venv
source venv/bin/activate        # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

–£—Å—Ç–∞–Ω–æ–≤–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∫–ª—é—á–∞ OpenAI:

```bash
export OPENAI_API_KEY="–í–ê–®_–ö–õ–Æ–ß"    # Windows: set OPENAI_API_KEY=–í–ê–®_–ö–õ–Æ–ß
```

–ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä:

```bash
uvicorn main:app --reload
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω –ø–æ–¥–Ω–∏–º–µ—Ç—Å—è –Ω–∞ `http://127.0.0.1:8000` (–∏–ª–∏ `http://localhost:8000`).

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã backend

- `GET /api/cases`  
  –°–ø–∏—Å–æ–∫ –∫–µ–π—Å–æ–≤ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ (–±–µ–∑ —Å–∫—Ä—ã—Ç–æ–π —á–∞—Å—Ç–∏).

- `GET /api/cases/{case_id}/teacher`  
  **–†–µ–∂–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è:** –ø–æ–ª–Ω—ã–π –∫–µ–π—Å —Å–æ —Å–∫—Ä—ã—Ç–æ–π —á–∞—Å—Ç—å—é:
  - –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–π –¥–∏–∞–≥–Ω–æ–∑
  - —Ü–µ–ª–∏ –æ–±—É—á–µ–Ω–∏—è
  - —Å–∏–º–ø—Ç–æ–º–∞—Ç–∏–∫–∞, —Å—Ç–∏–ª—å, —Ç–∏–ø–∏—á–Ω—ã–µ —Ñ—Ä–∞–∑—ã, —Ç—Ä–∏–≥–≥–µ—Ä—ã

- `POST /api/chat`  
  –î–∏–∞–ª–æ–≥ —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–º (–≤—ã–∑—ã–≤–∞–µ—Ç –º–æ–¥–µ–ª—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç ¬´–ø–∞—Ü–∏–µ–Ω—Ç–∞¬ª).

  –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:

  ```json
  {
    "session_id": "—Å—Ç—Ä–æ–∫–∞",
    "case_id": "case_gad_01",
    "user_message": "—Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ / –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞"
  }
  ```

- `GET /api/sessions/{session_id}`  
  **–†–µ–∂–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è:** —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —Ö–æ–¥ —Å–µ—Å—Å–∏–∏:
  - —Ç–µ–∫—É—â–∏–π case_id
  - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞ (`trust_level`, `emotional_intensity`, `fatigue`)
  - –∏—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (student / patient)

---

## 2. –ó–∞–ø—É—Å–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

1. –£–±–µ–¥–∏—Å—å, —á—Ç–æ backend —É–∂–µ –∑–∞–ø—É—â–µ–Ω.
2. –û—Ç–∫—Ä–æ–π —Ñ–∞–π–ª:

```text
frontend/index.html
```

–≤ –±—Ä–∞—É–∑–µ—Ä–µ (–¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –∏–ª–∏ —á–µ—Ä–µ–∑ ¬´–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª‚Ä¶¬ª).

### –ß—Ç–æ —É–º–µ–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- –í–≤–µ—Ä—Ö—É ‚Äî –≤—ã–±–æ—Ä –∫–µ–π—Å–∞ + –∫–Ω–æ–ø–∫–∞ ¬´–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è¬ª.
- –ù–∏–∂–µ ‚Äî –±–ª–æ–∫ —Å –∫—Ä–∞—Ç–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–µ–π—Å–µ (–∫–∞–∫ –≤–∏–¥–∏—Ç —Å—Ç—É–¥–µ–Ω—Ç).
- –°–ø—Ä–∞–≤–∞/–Ω–∏–∂–µ ‚Äî —á–∞—Ç —Å—Ç—É–¥–µ–Ω—Ç ‚Üî –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–∞—Ü–∏–µ–Ω—Ç.

### –†–µ–∂–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è

–í –±–ª–æ–∫–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Ç–∞–º –∂–µ, –≥–¥–µ –≤—ã–±–æ—Ä –∫–µ–π—Å–∞) –µ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å:

> ‚úÖ –†–µ–∂–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è

–ï—Å–ª–∏ –≤–∫–ª—é—á–∏—Ç—å:

- –ø–æ—è–≤–ª—è–µ—Ç—Å—è **–∂—ë–ª—Ç—ã–π –±–ª–æ–∫** ¬´–†–µ–∂–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è¬ª;
- –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:
  - –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–π –¥–∏–∞–≥–Ω–æ–∑
  - —Ü–µ–ª–∏ –æ–±—É—á–µ–Ω–∏—è
  - –ø–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–µ–π—Å–∞ (—Å–∏–º–ø—Ç–æ–º—ã, —Å—Ç–∏–ª—å, —Ç—Ä–∏–≥–≥–µ—Ä—ã)
- –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–ª–æ–∫ ¬´–•–æ–¥ —Å–µ—Å—Å–∏–∏¬ª:
  - —Ç–µ–∫—É—â–∏–π `session_id`
  - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞: –¥–æ–≤–µ—Ä–∏–µ, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å, —É—Å—Ç–∞–ª–æ—Å—Ç—å
  - —Å–ø–∏—Å–æ–∫ —Ä–µ–ø–ª–∏–∫ ‚Äî –∫—Ç–æ —á—Ç–æ —Å–∫–∞–∑–∞–ª (—Å—Ç—É–¥–µ–Ω—Ç / –ø–∞—Ü–∏–µ–Ω—Ç)

–ö–Ω–æ–ø–∫–∞ **¬´–û–±–Ω–æ–≤–∏—Ç—å —Ö–æ–¥ —Å–µ—Å—Å–∏–∏¬ª** –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç —Å–≤–µ–∂—É—é –∏—Å—Ç–æ—Ä–∏—é –∏–∑ backend.

> üëâ –¢–∞–∫ –º–æ–∂–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∫–ª—é—á–∏—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –Ω–∞ –ø—Ä–æ–µ–∫—Ç–æ—Ä–µ: —Å–≤–µ—Ä—Ö—É —á–∞—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞, –∞ –≤–Ω–∏–∑—É ‚Äî —Å–∫—Ä—ã—Ç–∞—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —á–∞—Å—Ç—å –∏ –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Å—Å–∏–∏.

---

## 3. Telegram-–±–æ—Ç —Å –≥–æ–ª–æ—Å–æ–º

### 3.1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `.env`

–ü–µ—Ä–µ–π–¥–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥ `bot/` –∏ —Å–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env`:

```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_–∏–∑_BotFather
OPENAI_API_KEY=—Ç–æ—Ç_–∂–µ_–∫–ª—é—á_—á—Ç–æ_–¥–ª—è_backend
BACKEND_URL=http://localhost:8000
```

> –ï—Å–ª–∏ backend –Ω–∞ –¥—Ä—É–≥–æ–º —Ö–æ—Å—Ç–µ/–ø–æ—Ä—Ç—É, –ø–æ–º–µ–Ω—è–π `BACKEND_URL`.

### 3.2. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

–í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è **—Ç–æ–π –∂–µ venv**, —á—Ç–æ –∏ –¥–ª—è backend:

```bash
cd backend
source venv/bin/activate             # –∏–ª–∏ venv\Scripts\activate –Ω–∞ Windows

cd ../bot
python bot.py
```

–ë–æ—Ç –Ω–∞–ø–µ—á–∞—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏ `Telegram bot started...`.

–¢–µ–ø–µ—Ä—å –≤ Telegram:

1. –ù–∞–π–¥–∏ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ –ø–æ –∏–º–µ–Ω–∏.
2. –ù–∞–∂–º–∏ `Start` –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å `/start`.
3. –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–µ–π—Å–æ–≤ (–æ–Ω –±–µ—Ä—ë—Ç –∏—Ö –∏–∑ backend `/api/cases`).
4. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –∫–µ–π—Å–∞ –º–æ–∂–Ω–æ:
   - –ø–∏—Å–∞—Ç—å **—Ç–µ–∫—Å—Ç–æ–º** ‚Äî –±–æ—Ç –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –Ω–∞ `/api/chat`;
   - –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å **–≥–æ–ª–æ—Å–æ–≤—ã–µ** ‚Äî –±–æ—Ç:
     - —Å–∫–∞—á–∏–≤–∞–µ—Ç –≥–æ–ª–æ—Å,
     - —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —á–µ—Ä–µ–∑ `whisper-1` (OpenAI),
     - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –≤ `/api/chat`,
     - –æ–∑–≤—É—á–∏–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç (Text-to-Speech) –∏ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç voice.

> ‚ö† TTS (–æ–∑–≤—É—á–∫–∞) –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ –≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ OpenAI.  
> –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–≤–µ—Ä—è–π—Å—è —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –∏ –∑–∞–º–µ–Ω–∏ `gpt-4o-mini-tts` –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—É—é TTS-–º–æ–¥–µ–ª—å.

---

## 4. –¢–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞

1. –û—Ç–∫—Ä—ã–ª `frontend/index.html`.
2. –í—ã–±—Ä–∞–ª –∫–µ–π—Å.
3. –ù–µ –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è.
4. –ü–∏—à–µ—Ç –≤–æ–ø—Ä–æ—Å—ã/—Ä–µ–ø–ª–∏–∫–∏ –ø–∞—Ü–∏–µ–Ω—Ç—É, —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç –Ω–∞–≤—ã–∫–∏.

### –î–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è

1. –¢–æ–∂–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `frontend/index.html`.
2. –í–∫–ª—é—á–∞–µ—Ç ¬´–†–µ–∂–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è¬ª.
3. –í–∏–¥–∏—Ç:
   - —Ü–µ–ª–∏ –æ–±—É—á–µ–Ω–∏—è,
   - —Å–∫—Ä—ã—Ç—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å–ª—É—á–∞—è,
   - –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ ‚Äî —Ö–æ–¥ —Å–µ—Å—Å–∏–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞.
4. –ú–æ–∂–µ—Ç —Ä–∞–∑–±–∏—Ä–∞—Ç—å —Å–µ—Å—Å–∏—é —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.

---

## 5. –í–∞–∂–Ω–æ

- –ü—Ä–æ–µ–∫—Ç ‚Äî **—É—á–µ–±–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä**, –Ω–µ —Ç–µ—Ä–∞–ø–∏—è –∏ –Ω–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞.
- –õ—é–±—ã–µ –≤—ã–≤–æ–¥—ã ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –∞ –Ω–µ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏.
